{
	"name": "MIS_Choice_Pax_Bags_to_SQL",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "MIS_Choice_Pax_Bags",
						"type": "DatasetReference"
					},
					"name": "MISChoicePaxBagsBlob"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "SQL_MIS_CHOICE_PAX_BAGS_TABLE",
						"type": "DatasetReference"
					},
					"name": "MISCHOICEPAXBAGSSQL"
				}
			],
			"transformations": [
				{
					"name": "PareMISData"
				},
				{
					"name": "AddWrkflwIDandTS"
				}
			],
			"script": "parameters{\n\tRunId as string\n}\nsource(output(\n\t\tFlight as (ID as string, SegmentNo as integer, ExternalID as string, CarrierCode as string, FlightNo as string, MarketingCarrierCode as string, MarketingFlightNo as string, Type as string, TailNo as string, OriginIATA as string, OriginICAO as string, OriginAirportName as string, OriginAirportCity as string, OriginAirportCountryCode as string, DepartureTerminal as string, DepartureGate as string, DestinationIATA as string, DestinationICAO as string, DestinationAirportName as string, DestinationAirportCity as string, DestinationAirportCountryCode as string, ArrivalTerminal as string, ArrivalGate as string, ScheduledDepartureTime as string, ScheduledDepartureTimeUTC as string, EstimatedDepartureTime as string, ScheduledArrivalTime as string, EstimatedArrivalTime as string, BoardingTime as string, Message as string, Status as string, EnablePassengerAPIS as boolean, EnableCrewAPIS as boolean, EnableDCS as boolean, WeightUnitsKgs as boolean, IsOpenSeating as boolean, IsProgressiveFlight as boolean, EnableThroughCheckIn as boolean, EnableIatciCheckIn as boolean, EnableBoarding as boolean, UseAveragePaxWeight as boolean, UseAverageBagWeight as boolean, PnlImported as boolean, IsCancelled as boolean, CancelledBy as string, CancelledReason as string, IsLocked as boolean, LockedBy as string, LockedReason as string, AircraftCapacity as integer, BookedPassengersCount as integer, TotalCargoLoad as integer, UpliftFuelLoad as integer, TotalFuelLoad as integer, RemainingFuelLoad as integer, Carrier as (CarrierName as string, Code as string, IATA as string, ICAO as string, ApisCarrierCode as string, IataMessagingCode as string, Prefix as string, Address as (ID as string, Location as string, Street1 as string, Street2 as string, City as string, StateCode as string, PostalCode as string, CountryCode as string, CustomData as (Properties as ({} as string))), Email as string, Website as string, Logo as string, Icon as string, DefaultFlightType as integer, DefaultIsTestEnvironment as boolean, DefaultIsOpenSeating as boolean, DefaultIsEnableBSMs as boolean, DefaultIsProgressiveFlight as boolean, DefaultEnableThroughCheckIn as boolean, DefaultEnableIatciCheckIn as boolean, DefaultDomesticBoardingTime as integer, DefaultInternationalBoardingTime as integer, DefaultWeightUnitsKgs as boolean, DefaultUseAveragePaxWeight as boolean, DefaultUseAverageBagWeight as boolean, DefaultAdultAge as integer, DefaultAverageAdultMaleWeight as integer, DefaultAverageAdultFemaleWeight as integer, DefaultChildAge as integer, SeatMapChildAge as integer, DefaultAverageChildWeight as integer, DefaultPassengerPaddedWeight as integer, HeavyBagAverageWeight as integer, HeavyBagThresholdWeight as integer, LifBagWeightCoefficientType as integer, LifBagAverageWeight as double, DefaultCurrencyCode as string, CurrencyConversionRounding as integer, ApisSenderID as string, ApisContactName as string, ApisTelephone as string, ApisFax as string, ApisEmail as string, TsaPreCheck as boolean, PnlImportCloseTime as integer, AdlImportCloseTime as integer, PermanentlyDeleteCancelledReservationsOnManifestImport as boolean, DefaultResidenceToNationalityOnManifestImport as boolean, IncludePassengerIdElementOnIataMessages as boolean, PrintFlightMessageOnBP as boolean, PrintOperatedByOnBP as boolean, PrintSSRsOnBP as boolean, PrintDocsOkForVerifiedPassengersOnBP as boolean, PrintReturnConnectingFlightBP as boolean, PrintBagWeightOnBT as boolean, IsPrintingBagTagWithoutCheckInAllowed as boolean, AllowBagsWithNoWeight as boolean, AllowPermanentDeleteNonPrintedBags as boolean, MaximumPassengerBags as integer, EmergencySeatInstructions as string, PremiumSeatInstructions as string, EmergencySeatGateStopInstructions as string, SelecteeGateStopInstructions as string, UnverifiedDocumentsGateStopInstructions as string, WatchlistNoFlyMatchInstructions as string, WatchlistPreventMatchInstructions as string, WatchlistSelecteeMatchInstructions as string, EmailSenderAddress as string, IsBoardingPassPrintWithUnpaidAncillariesAllowed as boolean, CustomData as (Properties as ({} as string))), AncillaryTemplateID as string, CustomerID as string, ApiInterfaceIDs as string, BatchPassengerMask as string, BatchCrewMemberMask as string, PreDepartureCloseOutPassengerMask as string, PostDepartureCloseOutPassengerMask as string, PreDepartureCloseOutCrewMemberMask as string, PostDepartureCloseOutCrewMemberMask as string, PaxFlightPreDepartureCloseOutStatus as string, PaxFlightPostDepartureCloseOutStatus as string, CrewFlightPreDepartureCloseOutStatus as string, CrewFlightPostDepartureCloseOutStatus as string, PaxBatchPreVetStatus as string, HasPassengerSecurityTransactions as boolean, HealthCheckRule as (ID as string, CarrierCode as string, OriginCountryEntity as string, DestinationCountryEntity as string, OriginAirport as string, DestinationAirport as string, Instructions as string, IsClearToBoard as boolean, IsRequirePassengerAttestation as boolean, AttestationMinorStartAge as integer, AttestationMinorEndAge as integer, IsRequireProofForRemoteCheckIn as boolean, IsRequireRemarksForFailStatus as boolean, IsActive as boolean, CreatedBy as string, CreatedTimestampUTC as string, UpdatedBy as string), IsNotificationAlertsOptional as boolean, IsContactTracingOptional as boolean, IsHealthCheckVerificationOptional as boolean, IsHealthCheckAttestationOptional as boolean, IsTestEnvironment as boolean, CheckedInPassengersCount as integer, CheckedBagsCount as integer, CustomData as (Properties as ({} as string))),\n\t\tSuccess as boolean\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tdocumentForm: 'documentPerLine') ~> MISChoicePaxBagsBlob\nMISChoicePaxBagsBlob select(mapColumn(\n\t\tID = Flight.ID,\n\t\tSegmentNo = Flight.SegmentNo,\n\t\tExternalID = Flight.ExternalID,\n\t\tFlightNo = Flight.FlightNo,\n\t\tType = Flight.Type,\n\t\tTailNo = Flight.TailNo,\n\t\tOriginIATA = Flight.OriginIATA,\n\t\tDestinationIATA = Flight.DestinationIATA,\n\t\tScheduledDepartureTimeUTC = Flight.ScheduledDepartureTimeUTC,\n\t\tStatus = Flight.Status,\n\t\tCheckedInPassengersCount = Flight.CheckedInPassengersCount,\n\t\tCheckedBagsCount = Flight.CheckedBagsCount\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> PareMISData\nPareMISData derive(ADF_TIMESTAMP = currentTimestamp(),\n\t\tRUN_ID = $RunId) ~> AddWrkflwIDandTS\nAddWrkflwIDandTS sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tID as string,\n\t\tSegmentNo as integer,\n\t\tExternalID as string,\n\t\tFlightNo as string,\n\t\tTailNo as string,\n\t\tOriginIATA as string,\n\t\tDestinationIATA as string,\n\t\tScheduledDepartureTimeUTC as string,\n\t\tStatus as string,\n\t\tCheckedInPassengersCount as integer,\n\t\tCheckedBagsCount as integer,\n\t\tADF_TIMESTAMP as timestamp,\n\t\tRUN_ID as string\n\t),\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\trecreate:true,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> MISCHOICEPAXBAGSSQL"
		}
	}
}